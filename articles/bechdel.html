<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bechdel analysis using the <code>tidyverse</code> • fivethirtyeight</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Bechdel analysis using the &lt;code&gt;tidyverse&lt;/code&gt;">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">fivethirtyeight</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/fivethirtyeight.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bechdel.html">Bechdel analysis using the `tidyverse`</a>
    </li>
    <li>
      <a href="../articles/biopics.html">Looking at Biopics of Hollywood</a>
    </li>
    <li>
      <a href="../articles/bob_ross.html">Bob Ross - Joy of Painting-</a>
    </li>
    <li>
      <a href="../articles/comics_gender.html">Gender in Comic Books</a>
    </li>
    <li>
      <a href="../articles/NBA.html">2015 NBA player predictions analysis using the `tidyverse`</a>
    </li>
    <li>
      <a href="../articles/tarantino_swears.html">How Many Fucks Does Tarantino Give?</a>
    </li>
    <li>
      <a href="../articles/trump_twitter.html">Trump Twitter analysis using the `tidyverse`</a>
    </li>
    <li>
      <a href="../articles/user_contributed_vignettes.html">User-Contributed Vignettes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rudeboybert/fivethirtyeight">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Bechdel analysis using the <code>tidyverse</code>
</h1>
                        <h4 class="author">Chester Ismay</h4>
            
            <h4 class="date">2018-02-26</h4>
          </div>

    
    
<div class="contents">
<p>This vignette is based on tidyverse-ifying the R code <a href="https://raw.githubusercontent.com/fivethirtyeight/data/master/bechdel/analyze-bechdel.R">here</a> and reproducing some of the plots and analysis done in the 538 story entitled “The Dollar-And-Cents Case Against Hollywood’s Exclusion of Women” by Walt Hickey available <a href="http://fivethirtyeight.com/features/the-dollar-and-cents-case-against-hollywoods-exclusion-of-women/">here</a>.</p>
<p>Load required packages to reproduce analysis. Also load the <code>bechdel</code> dataset for analysis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(fivethirtyeight)
<span class="co"># tidyverse includes ggplot2, tibble, tidyr, readr, purrr, dplyr:</span>
<span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(knitr)
<span class="kw">library</span>(magrittr)
<span class="kw">library</span>(broom)
<span class="kw">library</span>(stringr)
<span class="kw">library</span>(ggthemes)
<span class="kw">library</span>(scales)
<span class="co"># Turn off scientific notation</span>
<span class="kw">options</span>(<span class="dt">scipen =</span> <span class="dv">99</span>)</code></pre></div>
<div id="filter-to-only-1990---2013" class="section level2">
<h2 class="hasAnchor">
<a href="#filter-to-only-1990---2013" class="anchor"></a>Filter to only 1990 - 2013</h2>
<p>Focus only on films from 1990 to 2013</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bechdel90_13 &lt;-<span class="st"> </span>bechdel %&gt;%<span class="st"> </span><span class="kw">filter</span>(<span class="kw">between</span>(year, <span class="dv">1990</span>, <span class="dv">2013</span>))</code></pre></div>
</div>
<div id="calculate-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-variables" class="anchor"></a>Calculate variables</h2>
<p>Create international gross only and return on investment (ROI) columns and add to <code>bechdel_90_13</code> data frame</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bechdel90_13 %&lt;&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">int_only =</span> intgross_2013 -<span class="st"> </span>domgross_2013,
         <span class="dt">roi_total =</span> intgross_2013 /<span class="st"> </span>budget_2013,
         <span class="dt">roi_dom =</span> domgross_2013 /<span class="st"> </span>budget_2013,
         <span class="dt">roi_int =</span> int_only /<span class="st"> </span>budget_2013)</code></pre></div>
</div>
<div id="create-generous-variable" class="section level2">
<h2 class="hasAnchor">
<a href="#create-generous-variable" class="anchor"></a>Create <code>generous</code> variable</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bechdel90_13 %&lt;&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">generous =</span> <span class="kw">ifelse</span>(<span class="dt">test =</span> clean_test %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">"ok"</span>, <span class="st">"dubious"</span>),
                           <span class="dt">yes =</span> <span class="ot">TRUE</span>,
                           <span class="dt">no =</span> <span class="ot">FALSE</span>))</code></pre></div>
</div>
<div id="determine-median-roi-and-budget-based-on-categories" class="section level2">
<h2 class="hasAnchor">
<a href="#determine-median-roi-and-budget-based-on-categories" class="anchor"></a>Determine median ROI and budget based on categories</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ROI_by_binary &lt;-<span class="st"> </span>bechdel90_13 %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(binary) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">median_ROI =</span> <span class="kw">median</span>(roi_total, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
ROI_by_binary</code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   binary median_ROI
##   &lt;chr&gt;       &lt;dbl&gt;
## 1 FAIL         2.45
## 2 PASS         2.70</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bechdel90_13 %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(
    <span class="st">`</span><span class="dt">Median Overall Return on Investment</span><span class="st">`</span> =<span class="st"> </span><span class="kw">median</span>(roi_total, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   `Median Overall Return on Investment`
##                                   &lt;dbl&gt;
## 1                                  2.57</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">budget_by_binary &lt;-<span class="st"> </span>bechdel90_13 %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(binary) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">median_budget =</span> <span class="kw">median</span>(budget_2013, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
budget_by_binary</code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   binary median_budget
##   &lt;chr&gt;          &lt;dbl&gt;
## 1 FAIL        48385984
## 2 PASS        31070724</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bechdel90_13 %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="st">`</span><span class="dt">Median Overall Budget</span><span class="st">`</span> =<span class="st"> </span><span class="kw">median</span>(budget_2013, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   `Median Overall Budget`
##                     &lt;int&gt;
## 1                37878971</code></pre>
</div>
<div id="view-distributions" class="section level2">
<h2 class="hasAnchor">
<a href="#view-distributions" class="anchor"></a>View Distributions</h2>
<p>Look at the distributions of budget, international gross, ROI, and their logarithms</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> bechdel90_13, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> budget)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">"white"</span>, <span class="dt">bins =</span> <span class="dv">20</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Histogram of budget"</span>)</code></pre></div>
<p><img src="bechdel_files/figure-html/budget-plot-1.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> bechdel90_13, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(budget))) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">"white"</span>, <span class="dt">bins =</span> <span class="dv">20</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Histogram of Logarithm of Budget"</span>)</code></pre></div>
<p><img src="bechdel_files/figure-html/log-budget-plot-1.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> bechdel90_13, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> intgross_2013)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">"white"</span>, <span class="dt">bins =</span> <span class="dv">20</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Histogram of International Gross"</span>)</code></pre></div>
<p><img src="bechdel_files/figure-html/intgross-plot-1.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> bechdel90_13, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(intgross_2013))) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">"white"</span>, <span class="dt">bins =</span> <span class="dv">20</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Histogram of Logarithm of International Gross"</span>)</code></pre></div>
<p><img src="bechdel_files/figure-html/log-intgross-plot-1.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> bechdel90_13, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> roi_total)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">"white"</span>, <span class="dt">bins =</span> <span class="dv">20</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Histogram of ROI"</span>)</code></pre></div>
<p><img src="bechdel_files/figure-html/roi-plot-1.png" width="480"></p>
<p>The previous distributions were skewed, but ROI is so skewed that purposefully limiting the x-axis may reveal a bit more information about the distribution: (Suggested by <a href="https://github.com/mustafaascha">Mustafa Ascha</a>.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> bechdel90_13, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> roi_total)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">"white"</span>, <span class="dt">bins =</span> <span class="dv">20</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Histogram of ROI"</span>) +
<span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">25</span>)</code></pre></div>
<p><img src="bechdel_files/figure-html/roi-plot2-1.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> bechdel90_13, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(roi_total))) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">"white"</span>, <span class="dt">bins =</span> <span class="dv">20</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Histogram of Logarithm of ROI"</span>)</code></pre></div>
<p><img src="bechdel_files/figure-html/log-roi-plot-1.png" width="480"></p>
</div>
<div id="linear-regression-models" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-regression-models" class="anchor"></a>Linear Regression Models</h2>
<div id="movies-with-higher-budgets-make-more-international-gross-revenues-using-logarithms-on-both-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#movies-with-higher-budgets-make-more-international-gross-revenues-using-logarithms-on-both-variables" class="anchor"></a>Movies with higher budgets make more international gross revenues using logarithms on both variables</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> bechdel90_13, 
       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(budget_2013), <span class="dt">y =</span> <span class="kw">log</span>(intgross_2013))) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">"lm"</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="bechdel_files/figure-html/scatplot1-1.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gross_vs_budget &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(intgross_2013) ~<span class="st"> </span><span class="kw">log</span>(budget_2013), 
                      <span class="dt">data =</span> bechdel90_13)
<span class="kw"><a href="http://www.rdocumentation.org/packages/broom/topics/tidy">tidy</a></span>(gross_vs_budget)</code></pre></div>
<pre><code>##               term  estimate  std.error statistic       p.value
## 1      (Intercept) 2.4300342 0.38986884  6.232953  5.837437e-10
## 2 log(budget_2013) 0.9073902 0.02253341 40.268661 1.196182e-245</code></pre>
</div>
<div id="bechdel-dummy-is-not-a-significant-predictor-of-logintgross_2013-assuming-logbudget_2013-is-in-the-model" class="section level3">
<h3 class="hasAnchor">
<a href="#bechdel-dummy-is-not-a-significant-predictor-of-logintgross_2013-assuming-logbudget_2013-is-in-the-model" class="anchor"></a>Bechdel dummy is not a significant predictor of <code>log(intgross_2013)</code> assuming <code>log(budget_2013)</code> is in the model</h3>
<p>Note that the regression lines nearly completely overlap.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> bechdel90_13, 
       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(budget_2013), <span class="dt">y =</span> <span class="kw">log</span>(intgross_2013), 
                     <span class="dt">color =</span> binary)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">"lm"</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="bechdel_files/figure-html/scatplot2-1.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gross_vs_budget_binary &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(intgross_2013) ~<span class="st"> </span><span class="kw">log</span>(budget_2013) +<span class="st"> </span><span class="kw">factor</span>(binary), 
                      <span class="dt">data =</span> bechdel90_13)
<span class="kw"><a href="http://www.rdocumentation.org/packages/broom/topics/tidy">tidy</a></span>(gross_vs_budget_binary)</code></pre></div>
<pre><code>##                 term  estimate  std.error  statistic       p.value
## 1        (Intercept) 2.3585962 0.39888124  5.9130285  4.096087e-09
## 2   log(budget_2013) 0.9100772 0.02275659 39.9918064 3.385295e-243
## 3 factor(binary)PASS 0.0539207 0.06351936  0.8488861  3.960713e-01</code></pre>
<p>Note the <span class="math inline">\(p\)</span>-value on <code>factor(binary)PASS</code> here that is around 0.40.</p>
</div>
<div id="movies-with-higher-budgets-have-lower-roi" class="section level3">
<h3 class="hasAnchor">
<a href="#movies-with-higher-budgets-have-lower-roi" class="anchor"></a>Movies with higher budgets have lower ROI</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> bechdel90_13, 
       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(budget_2013), <span class="dt">y =</span> <span class="kw">log</span>(roi_total))) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">"lm"</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="bechdel_files/figure-html/scatplot3-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">roi_vs_budget &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(roi_total) ~<span class="st"> </span><span class="kw">log</span>(budget_2013), 
                      <span class="dt">data =</span> bechdel90_13)
<span class="kw"><a href="http://www.rdocumentation.org/packages/broom/topics/tidy">tidy</a></span>(roi_vs_budget)</code></pre></div>
<pre><code>##               term    estimate  std.error statistic            p.value
## 1      (Intercept)  2.43003419 0.38986884  6.232953 0.0000000005837437
## 2 log(budget_2013) -0.09260982 0.02253341 -4.109889 0.0000415837035927</code></pre>
<p>Note the negative coefficient here on <code>log(budget_2013)</code> and its corresponding small <span class="math inline">\(p\)</span>-value.</p>
</div>
<div id="bechdel-dummy-is-not-a-significant-predictor-of-logroi_total-assuming-logbudget_2013-is-in-the-model" class="section level3">
<h3 class="hasAnchor">
<a href="#bechdel-dummy-is-not-a-significant-predictor-of-logroi_total-assuming-logbudget_2013-is-in-the-model" class="anchor"></a>Bechdel dummy is not a significant predictor of <code>log(roi_total)</code> assuming <code>log(budget_2013)</code> is in the model</h3>
<p>Note that the regression lines nearly completely overlap.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> bechdel90_13, 
       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(budget_2013), <span class="dt">y =</span> <span class="kw">log</span>(roi_total), 
                     <span class="dt">color =</span> binary)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">"lm"</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="bechdel_files/figure-html/scatplot4-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">roi_vs_budget_binary &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(roi_total) ~<span class="st"> </span><span class="kw">log</span>(budget_2013) +<span class="st"> </span><span class="kw">factor</span>(binary), 
                      <span class="dt">data =</span> bechdel90_13)
<span class="kw"><a href="http://www.rdocumentation.org/packages/broom/topics/tidy">tidy</a></span>(roi_vs_budget_binary)</code></pre></div>
<pre><code>##                 term    estimate  std.error  statistic           p.value
## 1        (Intercept)  2.35859616 0.39888124  5.9130285 0.000000004096087
## 2   log(budget_2013) -0.08992278 0.02275659 -3.9515046 0.000081032919250
## 3 factor(binary)PASS  0.05392070 0.06351936  0.8488861 0.396071332112270</code></pre>
<p>Note the <span class="math inline">\(p\)</span>-value on <code>factor(binary)PASS</code> here that is around 0.40.</p>
</div>
</div>
<div id="dollars-earned-for-every-dollar-spent-graphic" class="section level2">
<h2 class="hasAnchor">
<a href="#dollars-earned-for-every-dollar-spent-graphic" class="anchor"></a>Dollars Earned for Every Dollar Spent graphic</h2>
<p>Calculating the values and creating a tidy data frame</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">passes_bechtel_rom &lt;-<span class="st"> </span>bechdel90_13 %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(generous ==<span class="st"> </span><span class="ot">TRUE</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">median_roi =</span> <span class="kw">median</span>(roi_dom, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
median_groups_dom &lt;-<span class="st"> </span>bechdel90_13 %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(clean_test %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">"men"</span>, <span class="st">"notalk"</span>, <span class="st">"nowomen"</span>)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(clean_test) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">median_roi =</span> <span class="kw">median</span>(roi_dom, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
pass_bech_rom &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">clean_test =</span> <span class="st">"pass"</span>, 
                  <span class="dt">median_roi =</span> passes_bechtel_rom$median_roi)
med_groups_dom_full &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(pass_bech_rom, median_groups_dom) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="st">"U.S. and Canada"</span>)</code></pre></div>
<pre><code>## Warning in bind_rows_(x, .id): binding character and factor vector,
## coercing into character vector</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">passes_bechtel_int &lt;-<span class="st"> </span>bechdel90_13 %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(generous ==<span class="st"> </span><span class="ot">TRUE</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">median_roi =</span> <span class="kw">median</span>(roi_int, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
median_groups_int &lt;-<span class="st"> </span>bechdel90_13 %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(clean_test %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">"men"</span>, <span class="st">"notalk"</span>, <span class="st">"nowomen"</span>)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(clean_test) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">median_roi =</span> <span class="kw">median</span>(roi_int, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
pass_bech_int &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">clean_test =</span> <span class="st">"pass"</span>, 
                  <span class="dt">median_roi =</span> passes_bechtel_int$median_roi)
med_groups_int_full &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(pass_bech_int, median_groups_int) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="st">"International"</span>)</code></pre></div>
<pre><code>## Warning in bind_rows_(x, .id): binding character and factor vector,
## coercing into character vector</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">med_groups &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(med_groups_dom_full, med_groups_int_full) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">clean_test =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/stringr/topics/str_replace">str_replace_all</a></span>(clean_test, 
                                      <span class="st">"pass"</span>,
                                      <span class="st">"Passes Bechdel Test"</span>),
         <span class="dt">clean_test =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/stringr/topics/str_replace">str_replace_all</a></span>(clean_test, <span class="st">"men"</span>,
                                      <span class="st">"Women only talk about men"</span>),
         <span class="dt">clean_test =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/stringr/topics/str_replace">str_replace_all</a></span>(clean_test, <span class="st">"notalk"</span>,
                                      <span class="st">"Women don't talk to each other"</span>),
         <span class="dt">clean_test =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/stringr/topics/str_replace">str_replace_all</a></span>(clean_test, <span class="st">"nowoWomen only talk about men"</span>,
                                      <span class="st">"Fewer than two women"</span>))
med_groups %&lt;&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">clean_test =</span> <span class="kw">factor</span>(clean_test, 
                                 <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">"Fewer than two women"</span>, 
                                            <span class="st">"Women don't talk to each other"</span>,
                                            <span class="st">"Women only talk about men"</span>,
                                            <span class="st">"Passes Bechdel Test"</span>))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">factor</span>(group, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">"U.S. and Canada"</span>, <span class="st">"International"</span>))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">median_roi_dol =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/scales/topics/dollar_format">dollar</a></span>(median_roi))</code></pre></div>
<p>Using only a few functions to plot</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> med_groups, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> clean_test, <span class="dt">y =</span> median_roi, 
                                        <span class="dt">fill =</span> group)) +
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>) +
<span class="st">  </span><span class="kw">facet_wrap</span>(~<span class="st"> </span>group) +
<span class="st">  </span><span class="kw">coord_flip</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Dollars Earned for Every Dollar Spent"</span>, <span class="dt">subtitle =</span> <span class="st">"2013 dollars"</span>) +
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggthemes/topics/scale_fivethirtyeight">scale_fill_fivethirtyeight</a></span>() +
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggthemes/topics/theme_fivethirtyeight">theme_fivethirtyeight</a></span>()</code></pre></div>
<p><img src="bechdel_files/figure-html/basic-538-1.png" width="768"></p>
<p>Attempt to fully reproduce <strong>Dollars Earned for Every Dollar Spent</strong> plot using <code>ggplot</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> med_groups, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> clean_test, <span class="dt">y =</span> median_roi, 
                                        <span class="dt">fill =</span> group)) +
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>) +
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> median_roi_dol), <span class="dt">hjust =</span> -<span class="fl">0.1</span>) +
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(.<span class="dv">25</span>, <span class="dv">0</span>)) +
<span class="st">  </span><span class="kw">coord_flip</span>() +
<span class="st">  </span><span class="kw">facet_wrap</span>(~<span class="st"> </span>group) +
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">"royalblue"</span>, <span class="st">"goldenrod"</span>)) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Dollars Earned for Every Dollar Spent"</span>, <span class="dt">subtitle =</span> <span class="st">"2013 dollars"</span>) +
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggthemes/topics/theme_fivethirtyeight">theme_fivethirtyeight</a></span>() +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> -<span class="fl">1.6</span>), 
        <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> -<span class="fl">0.4</span>),
        <span class="dt">strip.text.x =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">"bold"</span>, <span class="dt">size =</span> <span class="dv">16</span>),
        <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), 
        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.ticks.x =</span> <span class="kw">element_blank</span>()) +
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="bechdel_files/figure-html/roi-plot-538-1.png" width="768"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#filter-to-only-1990---2013">Filter to only 1990 - 2013</a></li>
      <li><a href="#calculate-variables">Calculate variables</a></li>
      <li><a href="#create-generous-variable">Create <code>generous</code> variable</a></li>
      <li><a href="#determine-median-roi-and-budget-based-on-categories">Determine median ROI and budget based on categories</a></li>
      <li><a href="#view-distributions">View Distributions</a></li>
      <li><a href="#linear-regression-models">Linear Regression Models</a></li>
      <li><a href="#dollars-earned-for-every-dollar-spent-graphic">Dollars Earned for Every Dollar Spent graphic</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Albert Y. Kim, Chester Ismay, Jennifer Chunn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
